# 探测周期性 - 实验报告

## 1. 实验目的

本实验旨在通过傅里叶变换分析太阳黑子数据的周期性，具体目标包括：
- 学习使用傅里叶变换分析时间序列数据中的周期性特征
- 掌握功率谱的计算和解释方法
- 理解太阳黑子活动的周期性规律及其物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据获取和预处理的方法
- 傅里叶变换的实现方式
- 功率谱的计算方法
- 峰值检测和周期确定的策略

_在此处填写您的方法描述（约200-300字）_
1. 数据获取和预处理：从本地文件加载太阳黑子数据，包含年份和每月太阳黑子数两列。
2. 傅里叶变换：使用快速傅里叶变换(FFT)将时域数据转换为频域表示。
3. 功率谱计算：计算变换后数据的幅度平方，得到功率谱密度。
4. 峰值检测：在功率谱中寻找最高峰值对应的频率，转换为周期。
5. 可视化：分别绘制时间序列图和功率谱图，直观展示周期性特征。
## 3. 实验结果

### 3.1 太阳黑子数据时间序列

请在此处粘贴您生成的太阳黑子数量随时间变化的图像，并简要说明您从图中观察到的周期性特征。

![image](https://github.com/user-attachments/assets/45fd506b-1959-4655-a4bc-0c7801313593)


图像说明：
时间序列图显示太阳黑子数量呈现明显的周期性波动，大约每10-11年达到一个峰值。波动幅度在不同周期中有所变化，但周期性特征显著。

### 3.2 功率谱分析

请在此处粘贴您生成的功率谱图像，并标明主要峰值对应的周期。
![image](https://github.com/user-attachments/assets/6924138d-1d2e-4186-859a-c0dd9a8304f0)




图像说明：
功率谱图在约132个月(11年)处出现明显峰值，这是太阳黑子的主周期。此外，在约66个月(5.5年)处有次峰，可能是半周期谐波。


### 3.3 周期确定

请列出您通过不同方法确定的太阳黑子周期：

| 确定方法 | 周期（月） | 周期（年） |
|---------|----------|----------|
| 目视估计 |  132         |    11.0        |
| 傅里叶分析 |   132.64      |   11.05       |

两种方法的相对误差：___0.38%__

## 4. 分析与讨论

### 4.1 太阳黑子周期的物理意义

请讨论太阳黑子周期的物理成因及其对地球的影响：
- 太阳黑子形成的物理机制是什么？
- 太阳黑子周期与太阳磁场活动有什么关系？
- 太阳黑子活动对地球气候、通信系统等有何影响？

太阳黑子是由太阳磁场活动引起的表面暗斑。它们的周期性变化反映了太阳磁场的周期性反转，即太阳活动周期。太阳黑子活动会影响：
1. 太阳辐射强度，进而影响地球气候；
2. 太阳风强度，干扰地球磁场和通信系统；
3. 高层大气密度，影响卫星轨道。


### 4.2 傅里叶变换方法的优缺点

讨论使用傅里叶变换分析周期性信号的优缺点：
- 傅里叶变换在分析周期性信号时的优势是什么？
- 在本实验中，傅里叶变换方法可能存在哪些局限性？
- 有哪些其他方法可以用来分析时间序列的周期性？它们与傅里叶变换相比有何异同？

优点：
- 能准确识别信号中的周期性成分
- 计算效率高（使用FFT算法）
- 可以量化不同频率成分的强度

缺点：
- 对非平稳信号效果不佳
- 需要足够长的数据才能分辨相近频率
- 无法提供时频局部信息

其他方法如小波变换可以分析时变频率特性，自相关函数可以直接检测周期性。

### 4.3 思考题

1. 如果太阳黑子数据中存在长期趋势（如逐年增加或减少的趋势），这会如何影响傅里叶分析的结果？应该如何处理这种趋势？

1. 长期趋势会在低频区产生虚假峰值，影响周期检测。可以通过去趋势（减去线性拟合）或高通滤波处理。

2. 太阳黑子数据从1749年开始记录，到现在已有270多年的数据。如果我们只使用最近100年的数据进行分析，结果会有什么不同？为什么？

2. 使用更短时间数据会降低频率分辨率，可能导致周期估计不准确。但现代数据质量更高，可能减少历史测量误差的影响

## 5. 结论

总结本实验的主要发现和收获，包括对太阳黑子周期性的认识以及傅里叶变换在周期性分析中的应用。

本实验通过傅里叶变换分析了太阳黑子数据的周期性，确定了约11年的主周期。这验证了已知的太阳活动周期，展示了傅里叶变换在周期性分析中的有效性。实验也揭示了太阳活动对地球环境的重要影响。

## 核心代码片段

请粘贴您实现的关键函数代码（如傅里叶变换和功率谱计算），并简要说明代码的核心思路。

```python
def compute_power_spectrum(sunspots):

    # TODO: 实现傅里叶变换和功率谱计算
    N = len(sunspots)
    yf = fft(sunspots)
    frequencies = fftfreq(N, 1)[:N//2]  # 每月一个数据点
    power = 2/N * np.abs(yf[0:N//2])
    return frequencies, power
```

代码说明：
实现傅里叶变换和功率谱计算
