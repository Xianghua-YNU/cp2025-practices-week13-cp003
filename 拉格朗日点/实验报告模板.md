# 拉格朗日点 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解地球-月球系统中L1拉格朗日点的位置，具体目标包括：
- 理解拉格朗日点的物理意义及其在天体力学中的重要性
- 推导L1点位置满足的方程
- 实现并比较不同的数值求根方法（牛顿法、弦截法）
- 分析数值方法的收敛性和精度

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- L1点位置方程的推导过程和物理意义
- 牛顿法和弦截法的实现策略
- 初值或初始区间的选择依据

_在地月系统中，L1点位置方程由地球引力、月球引力和离心力平衡关系推导而来，物理意义在于找到物体相对地月系统静止的位置。牛顿法通过迭代公式利用方程及其导数逼近解，弦截法利用两点函数值估计解的位置。牛顿法的初值基于对L1点位置的经验估计（约在地月距离的90%处），弦截法的初始区间则根据地月距离范围合理选择，确保包含解。_

## 3. 实验结果

### 3.1 L1点位置方程可视化

请在此处粘贴您生成的L1点位置方程图像，并简要说明图中的零点位置及其物理意义。

![image](https://github.com/user-attachments/assets/12ab5d4b-c4a6-486e-b869-d13672ac9a70)

图像说明：
_这个零点就是地月系统 L1 点的位置。在该位置，地球和月球的引力与物体随地月系统一起旋转所需的离心力达到平衡。
地球对物体的引力、月球对物体的引力以及物体随地月系统旋转所需的离心力共同作用，使得物体在该位置相对地月系统保持静止，即处于动态平衡状态。_
### 3.2 数值求解结果

请列出使用不同方法求解L1点位置的结果：

| 求解方法 | L1点位置 (m) | 相对于地月距离的比例 | 迭代次数 | 是否收敛 |
|---------|------------|-------------------|---------|--------|
| 牛顿法   |3.26045164e+08|0.848192           | 5       |  是    |
| 弦截法   |3.26044996e+08|0.848192           | 5       |  是    |
| fsolve  |3.26045072e+08|0.848192           | -       | -      |

### 3.3 不同方法的结果比较

请计算不同方法之间的结果差异：

| 比较项 | 绝对差异 (m) | 相对差异 (%) |
|-------|------------|-------------|
| 牛顿法 vs 弦截法 |1.67623739e+02|0.00005141%|
| 牛顿法 vs fsolve |9.24189367e+01|0.00002835%|
| 弦截法 vs fsolve |7.52048020e+01|0.00002307%|

## 4. 分析与讨论

### 4.1 L1点的物理意义

请分析L1点的物理意义及其在空间任务中的应用价值：
- L1点为什么能保持卫星相对于地球和月球静止？
- 在L1点放置卫星有什么实际应用？

_L1点是地月系统中的一个拉格朗日点，在该点，地球和月球的引力与物体随地月系统旋转所需的离心力达到平衡，使得物体能够保持相对静止。这意味着放置在L1点的卫星可以始终位于地球和月球之间的特定位置，与地月系统同步旋转。
空间观测 ：L1点位于地球和月球之间，从这里可以同时观测地球和月球，特别适合进行地月系统的科学研究和监测。
通信中继 ：L1点卫星可以作为地球和月球之间的通信中继站，确保数据传输的稳定性和连续性。
深空探测 ：L1点是进入深空的一个理想跳板，从这里发射探测器可以节省燃料并提高任务效率。_

### 4.2 数值方法的比较

讨论牛顿法和弦截法在求解此问题时的优缺点：
- 收敛速度比较
- 对初值/初始区间的敏感性
- 计算复杂度和实现难度

_收敛速度 ：牛顿法通常具有二次收敛速度，收敛速度非常快。在本问题中，牛顿法仅用了5次迭代就达到了收敛。弦截法的收敛速度稍慢于牛顿法，但仍具有超线性收敛速度，在本问题中同样在5次迭代内收敛。
对初值敏感性 ：牛顿法对初值较为敏感，如果初值选择不当，可能导致不收敛或收敛到错误的解。在本问题中，我们选择了一个接近真实解的初值，因此牛顿法能够正常收敛。弦截法对初始区间的依赖性较大，需要确保初始区间包含解，否则可能不收敛。在本问题中，我们选择了一个合理的初始区间，弦截法也成功收敛。
计算复杂度和实现难度 ：牛顿法需要计算函数的导数，这增加了计算复杂度和实现难度。弦截法不需要导数，仅需函数值，因此实现相对简单。不过，弦截法需要两个初始点来估计导数，这可能会增加一定的计算成本。_

### 4.3 思考题

1. 如果将地球质量M增加，L1点的位置将如何变化？请给出物理解释。

_如果地球质量M增加，L1点会向地球方向移动。地球质量增大意味着地球引力增强，而月球引力和离心力相对减小。因此，地球引力与月球引力及离心力的平衡点会更靠近地球。这使得L1点位置远离月球，更靠近地球。_

2. 除了L1点外，地球-月球系统还有其他拉格朗日点（L2-L5）。这些点的位置如何确定？它们各自有什么特点？

_L2 点 ：位于地月连线的延长线上，月球外侧。地球和月球的引力合力与物体的离心力平衡。在 L2 点，地球引力和月球引力的合力刚好提供物体随地月系统旋转所需的向心力。
L3 点 ：位于地球背向月球的延长线上，距离地球较远。地球引力和物体的离心力达到平衡。在 L3 点，地球引力对物体的拉力刚好等于物体随地月系统旋转所需的向心力。
L4 和 L5 点 ：分别位于地月系统两侧，与月球形成等边三角形的两个顶点处。地球、月球和物体之间的引力相互作用达到平衡。L4 点在月球运行轨道前方，L5 点在后方，物体在这两个点上受到的合力为零，可以稳定地与地月系统一起旋转。）_

## 5. 结论

总结本实验的主要发现和收获，包括对拉格朗日点物理意义的理解以及数值方法在天体力学问题中的应用。

_本实验通过数值方法成功求解了地月系统 L1 点的位置，并对不同数值方法进行了比较与分析。我们深入理解了 L1 点的物理意义，即地球和月球引力与物体随地月系统旋转的离心力平衡的点，以及其在空间任务中的重要应用，如空间观测、通信中继和深空探测等。同时，我们掌握了牛顿法和弦截法等数值方法在天体力学问题中的应用，理解了不同方法的优缺点，如牛顿法收敛速度快但对初值敏感，弦截法实现简单但收敛速度稍慢。通过实验，我们验证了数值方法在解决非线性方程中的有效性，为后续研究天体力学问题提供了有力的工具。_

## 核心代码片段

请粘贴您实现的关键函数代码（如L1点位置方程和牛顿法实现），并简要说明代码的核心思路。

```python
# 在此处粘贴核心代码片段（不超过30行）
```
def lagrange_equation(r):
    """
    L1拉格朗日点位置方程
    
    参数:
        r (float): 从地心到L1点的距离 (m)
    
    返回:
        float: 方程左右两边的差值，当r是L1点位置时返回0
    """
    # 地球引力
    earth_gravity = G * M / (r**2)
    
    # 月球引力 (注意方向与地球引力相反)
    moon_gravity = G * m / ((R - r)**2)
    
    # 离心力
    centrifugal_force = omega**2 * r
    
    # 力平衡方程
    return earth_gravity - moon_gravity - centrifugal_force

def newton_method(f, df, x0, tol=1e-8, max_iter=100):
    """
    使用牛顿法（切线法）求解方程f(x)=0
    
    参数:
        f (callable): 目标方程，形式为f(x)=0
        df (callable): 目标方程的导数
        x0 (float): 初始猜测值
        tol (float): 收敛容差
        max_iter (int): 最大迭代次数
    
    返回:
        tuple: (近似解, 迭代次数, 收敛标志)
    """
    x = x0
    iterations = 0
    converged = False
    
    for i in range(max_iter):
        fx = f(x)
        if abs(fx) < tol:
            converged = True
            iterations = i + 1
            break
        
        dfx = df(x)
        if abs(dfx) < 1e-14:  # 避免除以接近零的数
            break
        
        delta = fx / dfx
        x_new = x - delta
        
        # 检查相对变化是否小于容差
        if abs(delta / x) < tol:
            converged = True
            iterations = i + 1
            x = x_new
            break
        
        x = x_new
        iterations = i + 1
    
    return x, iterations, converged
代码说明：
_这段代码实现了求解地月系统 L1 拉格朗日点位置的核心功能。lagrange_equation 函数通过计算地球引力、月球引力和离心力的合力，构建了 L1 点的平衡方程。newton_method 函数实现了牛顿法，利用方程及其导数，通过迭代公式逐步逼近解的位置。代码通过设定收敛容差和最大迭代次数，确保了求解过程的稳定性和准确性。_
