# 薛定谔方程 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解一维方势阱中的量子能级问题，具体目标包括：
- 理解量子力学中的方势阱模型及其能级方程
- 实现并可视化方势阱能级方程
- 使用二分法数值求解超越方程，计算粒子能级
- 分析不同能级的分布规律及物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 如何处理方程中的数值计算问题（如避免过小数值导致的计算误差）
- 二分法求解超越方程的具体实现策略
- 如何区分和处理偶宇称和奇宇称能级

在本项目中，我们实现了对一维有限深方势阱中电子能级的数值求解和可视化。具体方法如下：

数值计算问题的处理：
为了避免数值误差，特别是由于普朗克常数、电子质量和势阱宽度带来的过小数值，我们采用了能量单位为电子伏（eV），并仅在需要计算中间变量（如α）时才将能量转换为焦耳（J）。这样大部分计算保留在易于处理的 eV 量级。同时，我们对 tan 函数的输出设置限制（例如 clip 在 -10 到 10 之间）以避免无穷大造成的图像不连续或计算异常。

二分法求解超越方程的实现策略：
我们首先将能量范围划分为大量小区间，对每个小区间的函数值进行符号比较，若存在符号变化（即根存在），则在该区间内使用二分法求解精确的根。每次迭代中计算中点，并判断根落在哪一侧，直到满足给定的能量精度（如 0.001 eV）。通过限制最大能量为 V-0.001 eV，避免了除零或负根号的数值异常。

偶宇称和奇宇称能级的处理：
能级具有宇称特性，偶数编号（n = 0, 2, 4, …）为偶宇称，对应方程 y1 = y2；奇数编号（n = 1, 3, 5, …）为奇宇称，对应方程 y1 = y3。在程序中，根据能级编号 n 的奇偶性自动选择使用哪一个超越方程，并分别在图中标注和求解它们的交点。这样确保了不同宇称条件下的能级都能正确求得。

## 3. 实验结果

### 3.1 能级方程可视化

请在此处粘贴您生成的能级方程图像，并简要说明图中各曲线的物理意义以及能级对应的交点位置。

![image](https://github.com/user-attachments/assets/1b83b5a5-5966-41c6-9e22-a0da4cea8611)

图像说明：
图像展示了三个随能量变化的函数曲线：$y_1 = \tan(\alpha)$、$y_2 = \sqrt{(V-E)/E}$ 和 $y_3 = -\sqrt{E/(V-E)}$。其中 $y_1$ 与 $y_2$、$y_3$ 的交点分别对应偶宇称和奇宇称的束缚态能级位置。从图中可视估计出约有6个交点，即该势阱支持6个束缚态。

### 3.2 能级计算结果

请列出您计算得到的前6个能级值，并与参考值进行比较：

| 能级序号 | 计算值 (eV) | 参考值 (eV) | 相对误差 (%) |
|---------|------------|------------|-------------|
| 0       |      0.318      | 0.318      |      0.08       |
| 1       |      1.270      | 1.270      |      0.02       |
| 2       |       2.851     | 2.851      |         0.02    |
| 3       |     5.050       | 5.050      |      0.00       |
| 4       |     7.850       | 7.850      |        0.00     |
| 5       |      11.215      | 11.215     |       0.00      |

## 4. 分析与讨论

### 4.1 能级分布规律

请分析计算得到的能级分布规律，特别是：
- 能级间隔是否均匀？随着能级增加，间隔如何变化？
- 这种分布规律与经典物理有何不同？体现了量子力学的哪些特性？

计算得到的能级分布并不均匀。随着能级的增加，相邻能级之间的间隔逐渐变大。例如，从第0级到第1级的间隔约为0.95 eV，而从第4级到第5级已增至约3.37 eV。这种非均匀分布与经典物理预测完全不同。在经典力学中，粒子在有限势阱中可以具有任意能量，能级是连续的。而在量子力学中，粒子的能量只能取特定的离散值，这是量子化的体现。此外，较高能级因接近势垒顶部，受到更强的边界条件限制，从而导致能级间距加快增大。这种现象反映了波动性、边界条件与量子隧穿效应对微观粒子行为的本质影响。


### 4.2 计算方法的精度与效率

讨论您使用的二分法在求解此类问题时的优缺点：
- 计算精度如何？是否足以满足物理问题的需求？
- 计算效率如何？是否有可能使用其他方法（如牛顿法）提高效率？

二分法作为一种稳健的根求解方法，具有收敛稳定、实现简单的优点。在本实验中，二分法能保证计算精度达到0.001 eV，完全满足物理问题对能级精度的需求。其计算效率相对较低，尤其是在能级较多或要求更高精度时，迭代次数增加，耗时增长明显。

相比之下，牛顿法及其变种依赖函数的导数信息，收敛速度快得多，但对初值依赖较强，若初值选取不当可能无法收敛或收敛到错误根。考虑到本问题中超越方程函数形态复杂且存在多根，二分法虽计算量较大，但更适合保证所有根的准确定位。

未来可结合二分法和牛顿法的优点，先用二分法定位根区间，再用牛顿法快速精确求解，以提升整体效率。

### 4.3 思考题

1. 如果增加势阱宽度 $w$，能级将如何变化？请给出物理解释。

势阱宽度增加意味着粒子运动的空间范围扩大，波函数的波长可以变长，导致能级间隔减小。即能级数目增加且单个能级能量下降。物理上，宽阱对应的波函数约束减弱，粒子束缚态变得更多，能量量子化更细密。



2. 如果将势阱高度 $V$ 改变，对能级分布有何影响？特别是，当 $V \to \infty$ 时，能级方程将如何简化？
当势阱高度 $V$ 增大时，束缚态的能级数目增加，最高能级趋近于 $V$。当 $V \to \infty$ 时，势阱变为无限深势阱，波函数在边界处严格为零，超越方程简化为 $\tan(\alpha) = 0$ 或 $\tan(\alpha) \to \infty$，即能级严格由 $\alpha = \dfrac{n\pi}{2}$ 决定，此时能级公式简洁且能级间隔均匀。

## 5. 结论

总结本实验的主要发现和收获，包括对量子力学基本概念的理解以及数值方法在物理问题中的应用。

本实验成功实现了一维有限深方势阱中粒子能级的数值求解与可视化，验证了量子力学中能级量子化的基本特征。通过对偶奇宇称能级的区分与求解，展示了超越方程的复杂性及其物理内涵。二分法虽然计算效率一般，但其稳健性使得求解过程可靠，精度满足实际需求。实验加深了对量子边界条件、波函数行为及数值方法应用的理解，为后续学习复杂量子系统和数值计算奠定基础。



## 核心代码片段

请粘贴您实现的关键函数代码（如二分法求解能级的函数），并简要说明代码的核心思路。

```python
# 在此处粘贴核心代码片段（不超过30行）
```
def bisection_method(f, a, b, tol=1e-3, max_iter=100):
    """
    二分法求根函数
    :param f: 目标函数，输入能量E，输出函数值
    :param a: 能量区间左端点
    :param b: 能量区间右端点
    :param tol: 收敛精度（eV）
    :param max_iter: 最大迭代次数
    :return: 方程根的近似值
    """
    fa = f(a)
    fb = f(b)
    if fa * fb > 0:
        return None  # 该区间无根

    for _ in range(max_iter):
        mid = (a + b) / 2
        fmid = f(mid)
        if abs(fmid) < tol or (b - a) / 2 < tol:
            return mid
        if fa * fmid < 0:
            b = mid
            fb = fmid
        else:
            a = mid
            fa = fmid
    return (a + b) / 2

代码说明：
该函数实现了二分法求解能级超越方程的根。首先检测区间端点函数值符号是否异号，确认根存在。然后不断将区间二分，选择包含根的子区间，迭代至满足给定误差。该方法简单易实现，保证收敛性，适用于求解多根存在的复杂函数。
