
# 傅立叶滤波和平滑 - 实验报告  

## 1. 实验目的  
本实验旨在通过对道琼斯工业平均指数数据进行傅立叶变换和滤波处理，达到以下目标：  
- 掌握傅立叶变换在金融时间序列分析中的应用  
- 理解不同频率成分对信号的影响  
- 学习通过频域滤波提取信号特征的方法  
- 分析滤波参数变化对结果的影响  


## 2. 方法简述  
### 数据加载和预处理  
使用`np.loadtxt`读取文本文件`dow.txt`中的指数数据，直接转换为一维数组。  

### 傅立叶变换和逆变换的实现  
1. **正向变换**：通过`np.fft.rfft`对时域数据进行实数傅立叶变换，将信号从时域转换为频域，得到频率系数数组`fft_coeff`（前半部分为低频，后半部分为高频）。  
2. **逆变换**：通过`np.fft.irfft`对滤波后的频域系数进行逆变换，恢复为时域信号。  

### 滤波器的设计原理  
- **保留前10%系数**：计算截断点`cutoff = int(len(fft_coeff) * 0.1)`，将`fft_coeff[cutoff:]`置零，保留低频成分，抑制后90%的高频成分。  
- **保留前2%系数**：同理，截断点设为`len(fft_coeff) * 0.02`，进一步滤除高频，仅保留极低频成分。  

### 可视化方法  
使用`matplotlib`绘制时间序列图：  
- 原始数据与滤波结果对比图用不同颜色区分（绿色为原始数据，红色为滤波结果），添加图例和网格线增强可读性。  
- 横轴为交易日序号，纵轴为指数值，标题标注滤波参数。  


## 3. 实验结果  

### 3.1 原始数据时间序列  
![image](https://github.com/user-attachments/assets/6882da97-72ae-431e-8a08-350eb642ff4e)


图像说明：  
原始数据呈现明显的波动性，包含高频短期波动和低频长期趋势。整体趋势可能存在上升或下降区间（需根据实际数据判断），局部存在剧烈震荡，反映市场每日交易的随机性和宏观经济影响。  

### 3.2 保留前10%系数的滤波结果  
![image](https://github.com/user-attachments/assets/0aa7abb3-e9bd-4622-bc7f-38c019950756)


图像说明：  
1. **差异**：滤波后信号显著平滑，高频波动减少，但仍保留部分中期波动（如几周至几个月的趋势）。  
2. **影响**：抑制高频成分后，信号更清晰地展现中期趋势，短期噪声被削弱，但未完全丢失细节（如局部峰值/谷值的位置仍可辨认）。  

### 3.3 保留前2%系数的滤波结果  
![image](https://github.com/user-attachments/assets/bd3eaca3-3827-47c4-8b1d-7bc0b8733dbb)


图像说明：  
1. **对比**：与10%滤波结果相比，2%滤波后的信号更为平滑，几乎呈单调趋势线，中期波动被进一步抑制。  
2. **影响**：严格滤波后，仅保留最核心的低频趋势（如年际变化），但牺牲了大部分细节，信号接近一条平滑曲线，难以反映季度内的市场变化。  


## 4. 分析与讨论  

### 4.1 不同滤波参数的影响  
- **差异**：保留10%系数时，信号保留了低频和部分中频成分，趋势与细节平衡；保留2%系数时，仅存极低频成分，趋势极端平滑但细节丢失。  
- **平滑程度**：滤波强度越高（保留比例越低），信号平滑度越高，高频噪声抑制越彻底。  
- **过度滤波问题**：可能导致信号失真，丢失关键转折点（如市场拐点），无法反映真实市场动态，需在趋势提取与细节保留间权衡。  

### 4.2 金融时间序列的频率特征  
- **低频成分**：反映长期经济趋势，如宏观经济周期（繁荣、衰退）、货币政策（利率变化）、企业盈利增长等慢变量的影响。  
- **高频成分**：由短期市场情绪（如散户交易、新闻事件）、技术性交易（如量化策略）、突发事件（如政策突变）等快变量引起，表现为日内或周内的价格波动。  

### 4.3 思考题  
1. **对数变换影响**：对数变换可将价格序列转换为收益率序列（更符合金融理论中的“平稳性假设”），傅立叶分析时可能更关注相对波动的频率成分，低频对应长期收益率趋势，高频对应短期收益波动。  
2. **非周期性问题**：傅立叶变换假设信号周期性延拓，金融数据非周期性会导致“频谱泄漏”（能量扩散到非真实频率），使频谱分析结果失真。可通过加窗函数（如汉宁窗）缓解，但无法完全消除。  


## 5. 结论  
### 主要发现与收获  
- **应用价值**：傅立叶滤波能有效分离金融数据中的趋势与噪声，帮助分析长期经济特征。  
- **参数选择**：保留10%系数适合平衡趋势与细节，保留2%适用于极端平滑需求，但需警惕信息丢失。  
- **挑战**：数据非周期性导致频谱泄漏，可通过加窗处理优化；实际应用中需结合金融理论验证滤波结果合理性。  

### 核心代码片段  
```python
def fourier_filter(data, keep_fraction=0.1):
    fft_coeff = np.fft.rfft(data)  # 傅立叶变换
    cutoff = int(len(fft_coeff) * keep_fraction)  # 计算截断点
    filtered_coeff = fft_coeff.copy()
    filtered_coeff[cutoff:] = 0  # 抑制高频成分
    filtered_data = np.fft.irfft(filtered_coeff)  # 逆变换回时域
    return filtered_data, fft_coeff

# 主函数调用示例
data = load_data('dow.txt')
filtered_10, _ = fourier_filter(data, 0.1)
filtered_2, _ = fourier_filter(data, 0.02)
```  

代码说明：  
核心思路为通过傅立叶变换将信号转换至频域，根据保留比例截断高频系数，再通过逆变换恢复时域信号。`keep_fraction`参数控制保留的低频成分比例，实现不同强度的低通滤波。
